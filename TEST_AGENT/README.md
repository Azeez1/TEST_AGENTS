# 🧪 TEST_AGENT - Multi-Agent Testing System

**5 AI testing agents powered by Claude Agent SDK - ready to use through Claude Code**

Generate comprehensive pytest test suites through natural conversation. Create unit tests, integration tests, edge case tests, and fixtures by simply talking to your AI testing team.

---

## 🚀 Quick Start

**No Python code to run. No setup. Just talk to Claude Code:**

```
You: "Use the test-orchestrator subagent to scan USER_STORY_AGENT and generate tests"

Claude: [Scans codebase]
        [Generates comprehensive test suite]
        [Returns 57 test cases with 89% coverage]
```

**That's it!** Your 5 testing agents are ready to use right now.

---

## 📚 **READ THIS FIRST**

**👉 [HOW_TO_USE.md](HOW_TO_USE.md)** - Complete usage guide with examples

**👉 [../MULTI_AGENT_GUIDE.md](../MULTI_AGENT_GUIDE.md)** - Universal guide for all agents

These guides explain:
- How to invoke each of the 5 agents
- Real-world examples with actual output
- Common workflows
- Tips & best practices

---

## 🤖 Your 5 Testing Agents

| Agent | Purpose | Invoke With |
|-------|---------|-------------|
| **test-orchestrator** | Coordinates all testing | `"Use test-orchestrator to scan my code"` |
| **unit-test-agent** | Unit tests for functions/classes | `"Use unit-test-agent to test module.py"` |
| **integration-test-agent** | Integration & workflow tests | `"Use integration-test-agent for workflow"` |
| **edge-case-agent** | Edge case identification | `"Use edge-case-agent for validation"` |
| **fixture-agent** | Pytest fixtures & mocks | `"Use fixture-agent for test data"` |

---

## 🎯 How It Works

### The Truth About Multi-Agent Systems

Your agents are **specialized personas** that I (Claude Code) adopt.

When you say:
```
"Use the test-orchestrator subagent to scan my codebase"
```

**What happens:**
1. I (Claude) read `.claude/agents/test-orchestrator.md`
2. I adopt that agent's instructions and persona
3. I use the tools specified for that agent
4. I scan codebase, delegate to specialists, generate tests
5. I return comprehensive test suite to you

**No Python orchestrator needed** - I AM the orchestrator.

---

## 💡 Usage Examples

### Example 1: Complete Test Suite Generation

```
You: "Use test-orchestrator to scan ../USER_STORY_AGENT and generate comprehensive tests"

Claude (as test-orchestrator):
  [Using scan_codebase tool...]

  Found:
  - 14 Python files
  - 45 functions
  - 12 classes

  Delegating to specialist agents:

  [Invoking unit-test-agent for story_generator.py...]
  ✅ Generated 15 unit tests

  [Invoking edge-case-agent for file_handlers.py...]
  ✅ Identified 18 edge cases

  [Invoking fixture-agent...]
  ✅ Created conftest.py with 5 fixtures

  Test Suite Complete!

  Generated:
  - tests/test_story_generator.py (15 tests)
  - tests/test_file_handlers.py (12 tests)
  - tests/test_edge_cases.py (18 tests)
  - tests/conftest.py (fixtures)

  Total: 57 test cases
  Coverage: 89.5%
```

### Example 2: Unit Tests for Specific Module

```
You: "Use unit-test-agent to generate tests for file_handlers.py"

Claude (as unit-test-agent):
  [Using analyze_function tool...]

  Analyzing file_handlers.py...

  Found:
  - read_file(file_path: str) -> str
  - write_file(file_path: str, content: str) -> bool
  - validate_file_type(file_path: str, allowed_types: list) -> bool

  Generating tests...

  # tests/test_file_handlers.py
  """
  Tests for file_handlers module
  Generated by Unit Test Agent
  """

  import pytest
  from unittest.mock import Mock, patch, mock_open
  from file_handlers import read_file, write_file, validate_file_type


  class TestReadFile:
      """Tests for read_file()"""

      def test_read_file_when_valid_path_then_returns_content(self):
          """Test reading a valid file"""
          # Arrange
          with patch('builtins.open', mock_open(read_data='test content')):
              # Act
              result = read_file('test.txt')
              # Assert
              assert result == 'test content'

      def test_read_file_when_not_exists_then_raises_file_not_found(self):
          """Test file not found error"""
          with pytest.raises(FileNotFoundError):
              read_file('nonexistent.txt')

      # ... [9 more tests]

  ===== Tests Generated =====

  Created: tests/test_file_handlers.py
  - 3 test classes
  - 11 test functions
  - Includes mocking, parametrization, edge cases

  Run with: pytest tests/test_file_handlers.py
```

### Example 3: Automatic Delegation

```
You: "Generate comprehensive tests for my story generator"

Claude: [Automatically invokes test-orchestrator]
        [Scans codebase]
        [Delegates to specialists]
        [Returns complete test suite]
```

---

## ⚙️ Setup (One-Time)

### 1. Install Dependencies

```bash
cd TEST_AGENT
pip install -r requirements.txt
```

Requirements include:
- pytest
- pytest-cov
- pytest-asyncio
- pytest-mock

### 2. Configure Coverage Threshold (Optional)

Create or edit `pytest.ini`:
```ini
[pytest]
testpaths = tests
python_files = test_*.py
python_classes = Test*
python_functions = test_*
addopts =
    -v
    --cov
    --cov-report=term-missing
    --cov-report=html
    --cov-fail-under=80
markers =
    slow: marks tests as slow
    integration: marks tests as integration tests
```

---

## 🛠️ Agent Capabilities

### Test Orchestration
- **test-orchestrator** - Scans codebase, coordinates specialists, runs tests, analyzes coverage

### Unit Testing
- **unit-test-agent** - Generates unit tests with AAA pattern, mocking, parametrization

### Integration Testing
- **integration-test-agent** - Creates end-to-end tests, workflow tests, module interaction tests

### Edge Cases
- **edge-case-agent** - Identifies boundary values, empty inputs, special characters, security cases

### Test Data
- **fixture-agent** - Creates pytest fixtures, mock objects, factory fixtures

---

## 📖 Documentation Structure

```
TEST_AGENT/
├── HOW_TO_USE.md                    ← Start here!
├── README.md                         ← You are here
├── .claude/
│   └── agents/                       ← 5 agent definitions
│       ├── test-orchestrator.md
│       ├── unit-test-agent.md
│       ├── integration-test-agent.md
│       ├── edge-case-agent.md
│       └── fixture-agent.md
├── tools/                            ← Custom testing tools
│   ├── router_tools.py
│   ├── code_analysis_tools.py
│   ├── test_generation_tools.py
│   └── execution_tools.py
└── archive/
    └── orchestrator.py               ← Old approach (archived)
```

---

## 🎓 Learn More

**[HOW_TO_USE.md](HOW_TO_USE.md)** - Detailed guide with examples for each agent

**[../MULTI_AGENT_GUIDE.md](../MULTI_AGENT_GUIDE.md)** - Understanding multi-agent systems

**Agent Definitions:** Check `.claude/agents/` to see each agent's:
- Specialized instructions
- Available tools
- Capabilities

---

## 🔧 Troubleshooting

### "Agent isn't working"
- Verify agent `.md` file exists in `.claude/agents/`
- Be more specific in your request
- Check [HOW_TO_USE.md](HOW_TO_USE.md) for examples

### "Tests not generating"
- Ensure target path is valid Python code
- Check pytest is installed: `pip install pytest`
- Verify tools are registered correctly

### "Coverage analysis failed"
- Need pytest-cov: `pip install pytest-cov`
- Coverage data might not exist (run tests first)
- Check pytest.ini configuration

### "Generated tests don't run"
- Check imports in generated test files
- Verify source modules are in Python path
- Run: `pytest tests/ -v` for detailed output

---

## 🚀 Quick Examples to Try

**Generate your first tests:**
```
"Use test-orchestrator to scan ../USER_STORY_AGENT"
```

**Unit tests for specific module:**
```
"Use unit-test-agent to generate tests for story_generator.py"
```

**Find edge cases:**
```
"Use edge-case-agent to identify edge cases in file validation"
```

**Create test fixtures:**
```
"Use fixture-agent to create fixtures for database tests"
```

---

## 📝 Notes

### About the Archived Orchestrator

You'll find `orchestrator.py` in the `archive/` folder. This was an earlier attempt to create a Python program that would invoke agents. **It's not needed anymore** because:

- Agent definitions are used directly by Claude Code
- No Python orchestrator required
- Simpler and more powerful to just talk to Claude

**The agent definitions (`.claude/agents/*.md`) are what matter** - they're perfectly formatted and ready to use.

---

## 🎯 What's Next?

1. **Read [HOW_TO_USE.md](HOW_TO_USE.md)** - Complete guide with examples
2. **Try invoking an agent** - Start with something simple
3. **Explore agent definitions** - See what each can do in `.claude/agents/`
4. **Experiment** - Try automatic delegation by just describing tasks

---

## 📚 Additional Resources

- **Claude Code Documentation:** https://docs.claude.com/claude-code
- **Agent Definitions:** `.claude/agents/`
- **Tools Source Code:** `tools/`
- **pytest Documentation:** https://docs.pytest.org/

---

## 🧬 Generated Test Structure

Your testing agents follow pytest best practices:

### Test Naming Convention
```python
test_function_when_condition_then_expected()
```

### AAA Pattern (Arrange-Act-Assert)
```python
def test_example():
    # Arrange: Set up test data
    input_data = "test"

    # Act: Execute the function
    result = function_under_test(input_data)

    # Assert: Verify results
    assert result == expected
```

### Fixtures Over Setup
```python
@pytest.fixture
def sample_data():
    """Reusable test data"""
    return {"key": "value"}
```

### Appropriate Mocking
```python
@patch('module.external_call')
def test_with_mock(mock_external):
    mock_external.return_value = "mocked"
    result = function()
    assert result is not None
```

---

## 📊 Test Coverage Goals

The Test Agent aims for:
- **80%+ overall coverage** (configurable in pytest.ini)
- **Unit tests**: 80% of all tests (individual functions/methods)
- **Integration tests**: 15% of all tests (module interactions)
- **Edge cases**: 5% of all tests (boundary conditions)

---

## 🚦 Test Types Generated

### 1. Unit Tests
- Function-level testing
- Class method testing
- Property testing
- Mock external dependencies

### 2. Integration Tests
- Module interaction testing
- Workflow testing
- End-to-end scenarios
- External service integration

### 3. Edge Case Tests
- Boundary values (zero, negative, max)
- Empty inputs, None/null values
- Special characters, Unicode
- Security cases (SQL injection, XSS)

### 4. Error Tests
- Invalid input types
- Missing parameters
- Exception handling
- Error propagation

---

**Your 5 testing agents are ready!** Just start talking to Claude Code.

See [HOW_TO_USE.md](HOW_TO_USE.md) for detailed instructions and examples. 🚀
